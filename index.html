<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <title>商加在线</title>
    <link href="assets/css/amazeui.css" rel="stylesheet" />
    <link href="assets/css/linjia.css" rel="stylesheet" />
    <script src="assets/js/jquery.min.js" type="text/javascript"></script>
    <script src="assets/js/amazeui.js"></script>
    <style type="text/css">
        .footer .uf1 {
            background-color:#fff!important
        }
    </style>
</head>
<body>
    <div class="page box box-v">

        <div class="uf1 am-text-center of-y-s">

        </div>

        <div class="footer box box-h menu">
            <div class="uf1 am-text-center active" ontouchend="switchBtn(this,0)" style="padding-top:5px;">
                <div><span><img src="image/home2.png" style="height:22px;" id="homeicon"></span></div>
                <div class="text" style="font-size:12px!important">首页</div>
            </div>

            <div class="uf1 am-text-center" ontouchend="switchBtn(this,1)" style="padding-top:5px">
                <div><span><img src="image/round.png" style="height:22px;" id="roundicon"></span></div>
                <div class="text" style="font-size:12px!important">商圈</div>
            </div>

            <div class="uf1 am-text-center " ontouchend="switchBtn(this,2)" style="padding-top:5px">
                <div><span><img src="image/dsh.png" style="height:22px;" id="dshicon"></span></div>
                <div class="text" style="font-size:12px!important">消息</div>
            </div>

            <div class="uf1 am-text-center" ontouchend="switchBtn(this,3)" style="padding-top:5px">
                <div><span><img src="image/discover.png" style="height:22px;" id="discovericon"></span></div>
                <div class="text" style="font-size:12px!important">银票</div>
            </div>

            <div id="f-last" class="uf1 am-text-center" ontouchend="switchBtn(this,4)" style="padding-top:5px">
                <div><span><img src="image/my.png" style="height:22px;" id="myicon"></span></div>
                <div class="text" style="font-size:12px!important">我的</div>
            </div>
        </div>

    </div>

    <script src="assets/js/api.js"></script>
    <script src="assets/js/sapi.js"></script>
    <script src="script/hammer.min.js"></script>
    <script type="text/javascript">
        var header = 105;
        var footer_h = 0;
        var body_h = 0;
        apiready = function () {
            body_h = $(window).height();
            footer_h = $(".footer").height() + 2;
            header = $("#home").height() ;
            var rect_h = body_h - footer_h - header;
            api.openFrame({
                name: 'home-index',
                url: 'html/home/index.html',
                bounces: false, vScrollBarEnabled: false,
                rect: {
                    x: 0,
                    y: header,
                    w: 'auto',
                    h: rect_h,
                }
            });
        }

        // 随意切换按钮
        function switchBtn(obj, index) {
            var body_h = $(window).height();
            var footer_h = $(".footer").height() + 2;

            switch (index) {
                case 0:
                    $(".active").removeClass("active");
                    $(obj).addClass("active");
                    $(".tt").hide();
                    $("#homeicon").attr("src", "image/home2.png");
                    $("#roundicon").attr("src", "image/round.png");
                    $("#dshicon").attr("src", "image/dsh.png");
                    $("#discovericon").attr("src", "image/discover.png");
                    $("#myicon").attr("src", "image/my.png");
                    
                    var rect_h = body_h - footer_h - header;
                    api.openFrame({
                        name: 'home-index',
                        url: 'html/home/index.html',
                        vScrollBarEnabled: false,
                        bounces: false,
                        rect: {
                            x: 0,
                            y: header,
                            w: 'auto',
                            h: rect_h,
                        }
                    });
                    break;
                case 1:
                    getLocation();
                    $(".active").removeClass("active");
                    $(obj).addClass("active");
                    $(".tt").hide();
                    $("#homeicon").attr("src", "image/home.png");
                    $("#roundicon").attr("src", "image/round2.png");
                    $("#dshicon").attr("src", "image/dsh.png");
                    $("#discovericon").attr("src", "image/discover.png");
                    $("#myicon").attr("src", "image/my.png");
                    api.sendEvent({ name: "near" });
                    var rect_h = body_h - footer_h - header;
                    api.openFrame({
                        name: 'store-nearstore',
                        url: 'html/store/nearstore.html', vScrollBarEnabled: false,
                        bounces: false,
                        rect: {
                            x: 0,
                            y: header,
                            w: 'auto',
                            h: rect_h,
                        }
                    });
                    break;
                case 2:
                    $(".active").removeClass("active");
                    $(obj).addClass("active");
                    $(".tt").hide();
                    $("#homeicon").attr("src", "image/home.png");
                    $("#roundicon").attr("src", "image/round.png");
                    $("#dshicon").attr("src", "image/dsh2.png");
                    $("#discovericon").attr("src", "image/discover.png");
                    $("#myicon").attr("src", "image/my.png");
                 
                    var rect_h = body_h - footer_h - header;
                    api.openFrame({
                        name: 'home-hdevelop',
                        url: 'html/home/hdevelop.html', vScrollBarEnabled: false,
                        //url: 'html/info/coursetest.html', vScrollBarEnabled: false,
                        bounces: false,
                        rect: {
                            x: 0,
                            y: header,
                            w: 'auto',
                            h: rect_h,
                        }
                    });
                    break;
                case 3:
                    getLocation();
                    $(".active").removeClass("active");
                    $(obj).addClass("active");
                    $(".tt").hide();
                    $("#homeicon").attr("src", "image/home.png");
                    $("#roundicon").attr("src", "image/round.png");
                    $("#dshicon").attr("src", "image/dsh.png");
                    $("#discovericon").attr("src", "image/discover2.png");
                    $("#myicon").attr("src", "image/my.png");
                    api.sendEvent({ name: "loadTalk" });
                    var rect_h = body_h - footer_h - header;
                    api.openFrame({
                        name: 'message-talk',
                        url: 'html/message/talk.html', vScrollBarEnabled: true,
                        bounces: false,
                        rect: {
                            x: 0,
                            y: header,
                            w: 'auto',
                            h: rect_h,
                        }
                    });
                    break;
                case 4:
                    $(".active").removeClass("active");
                    $(obj).addClass("active");
                    $(".tt").hide();
                    $("#homeicon").attr("src", "image/home.png");
                    $("#roundicon").attr("src", "image/round.png");
                    $("#dshicon").attr("src", "image/dsh.png");
                    $("#discovericon").attr("src", "image/discover.png");
                    $("#myicon").attr("src", "image/my2.png");

                    var rect_h = body_h - footer_h - header;
                    api.openFrame({
                        name: 'mine-mine',
                        url: 'html/mine/mine_edition2.html', vScrollBarEnabled: true,
                        bounces: false,
                        rect: {
                            x: 0,
                            y: header,
                            w: 'auto',
                            h: rect_h,
                        }
                    });
                    break;
            }
        }

        var getLocation = function () {
            //bmap获取经纬度及地址
            var bMap = api.require('bMap');

            bMap.getLocation({
                accuracy: '100m',
                autoStop: true,
                filter: 1
            }, function (ret, err) {
                if (ret.status) {
                    //alert(JSON.stringify(ret));
                    localStorage["lon"] = ret.lon;
                    localStorage["lat"] = ret.lat;
                } else {
                    //alert(err.code);
                    //alert(err.msg);
                    api.toast({
                        msg: '获取坐标信息失败...',
                        duration: 2000,
                        location: 'bottom'
                    });
                }
            });
        }
    </script>
</body>

</html>